---

import Layout from '../../layouts/Layout.astro';

import { getPages, getPage, getProducts, getProduct } from "../../lib/api.js";
import SliderIngredients from "../../components/SliderIngredients.vue"
import CardIngredient from "../../components/CardIngredient.vue"
import Divider from '../../components/Divider.vue';
import SubHeader from '../../components/subHeader.vue';


const { slug } = Astro.params;
const page = await getProduct(slug , 'en');



console.log(page)

---

<Layout>
    
    <SubHeader section={page?.acf?.sub_header} client:only ></SubHeader>
    
    <div class="product-page bg-black text-white">
        <div class="product-info">
            
            <div class="back-image-container h-[100dvh] w-[100vw] flex justify-center items-center">
                <div class="image-wrapper w-[calc((541/1515)*100vw)] h-[100dvh] flex items-center">
                    <img class="w-full" src={page?._embedded["wp:featuredmedia"]?.[0]?.source_url} >
                </div>
                <h1 class="absolute top[50%] text-product">{page.title.rendered}</h1>
            </div>
            <section id="overview" class="product-info-container flex min-h-[100dvh]">
                <div class="gallery w-1/2">
                    <div class="image-wrapper w-[calc((541/1515)*100vw)] h-[100dvh] flex items-center relative">
                        {page?.acf?.product_highlights?.map((highlight: any) => (
                            <p class="highlight flex items-center gap-2"><span class="bg-white block rounded-full w-[6px] h-[6px]"></span>{highlight.highlight}</p>
                        ))}
                    </div>
                    
                    {page?.acf?.gallery?.map((image: any) => (
                        <div
                          class="image-wrapper w-full flex items-center aspect-[726/856] overflow-hidden relative"
                        >
                          <img class="absolute w-full object-cover" src={image.image.url} alt={image.image.alt} />
                        </div>
                      ))}
                   
                </div>
                <div class="info-column w-1/2 text-center h-[100dvh] px-product-description py-xxl-2">
                    <span class="block pb-lg">( {page.title.rendered} )</span>
                    <h2 class="text-title pb-xxl leading-[120%]">{page?.acf?.title}</h2>
                    <p class="text-left pb-lg-2 ">{page?.acf?.description}</p>
                    <div class="inside py-lg border-b-white border-y mb-lg-2">
                        <h3 class="uppercase pb-md">{page?.acf?.inside_the_cut?.title}</h3>
                        <p class="max-w-max-ssm mx-auto">{page?.acf?.inside_the_cut?.items}</p>
                    </div>
                    <div class="tabs flex-col text-left">
                        <div class="tab-header flex border-b border-white">
                            {page?.acf?.tabs?.map((tab: any, index: number) => (
                                <div class="tab w-1/3 relative text-center" data-id={index}>
                                    <p class="text-p-small text-nowrap py-2 cursor-pointer">{tab.tab.title}</p>
                                </div>
                              ))}
                              <span class="tab-indicator absolute bottom-0 w-1/3 bg-white"></span>
                        </div>
                        <div class="tab-inside flex-col">
                            {page?.acf?.tabs?.map((tab: any, index: number) => (
                                <div class="tab-inside hidden py-md" data-id={index}>
                                    <p>{tab.tab.description}</p>
                                </div>
                            ))}
                        </div>
                    </div>

                </div>
            </section>
            <Divider></Divider>
            <section id="ingredients" class="ingredients pb-product-description text-center mt-xxl-2 pl-sm">
                <span class="block pb-lg">({page?.acf?.ingredients?.pretitle})</span>
                <h2 class="text-title text-leading[120%] pb-xxl-2">{page?.acf?.ingredients?.title}</h2>
                <div class="ingredients scroll-wrapper flex">
                    {page?.acf?.ingredients?.ingredients?.map((ingredient: any, index: number) => (
                        <CardIngredient class="card" ingredient={ingredient} client:load></CardIngredient>
                    ))}
                </div>
                <!-- <SliderIngredients ingzredients={page?.acf?.ingredients} client:load></SliderIngredients> -->
            </section>
            
            <section id="recipes" class="section-button pb-product-description">
                <div class="button-wrapper p-sm w-full h-[60vh] mb-xxl-2">
                    <a class="w-full text-white h-full flex justify-center items-center border border-white rounded-full hover:border-none hover:bg-white hover:text-black" href={page?.acf?.link?.url}>{page?.acf?.link?.title}</a>
                </div>
            </section>

            <section class="video-section">
                <div class="video-wrapper aspect-[1518/968] flex justify-center items-center">
                    <video class="absolute object-cover w-full" controls poster={page?.acf.video?.poster?.link} src={page?.acf.video?.video?.link}></video>
                </div>

            </section>

            <Divider></Divider>
            <section id="faq" class="faqs pb-product-description text-center p-sm">
                <div class="scroll-wrapper flex w-fit items-center h-[80dvh] gap-xs">
                    
                <div class="card w-[400px] h-fit aspect-[3/4] p-lg-2 bg-stone flex flex-col  justify-between rounded-[15px]">
                    <div>
                        <span class="block pb-lg text-p-small ">(FAQs)</span>
                        <h3 class="block pb-lg text-title">{page?.acf?.faqs?.title}</h3>
                    </div>
                    <p class="">{page?.acf?.faqs?.more_info}</p>
                </div>
               
                {page?.acf?.faqs?.cards?.map((card: any) => (
                    <div class="card  w-[400px] h-fit aspect-[3/4] p-lg-2 bg-ash flex flex-col justify-between rounded-[15px]">
                        <p class="text-title-sm">{card.question}</p>
                        <p class="text-p-small">{card.answer}</p>
                        
                    </div>
                  ))}
                  </div>
            </section>
            <Divider></Divider>
            <section class="section-button-empty pb-product-description">
                <div class="button-wrapper p-sm w-full h-[60vh] mb-xxl-2 relative">
                    <a class="w-full text-white h-full flex justify-center items-center border border-white rounded-full hover:border-none hover:bg-white hover:text-black" href={page?.acf?.link?.url}>Order</a>
                </div>
            </section>
            
            
        </div>

    </div>
</Layout>
